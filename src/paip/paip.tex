% -*- mode: noweb; ess-noweb-default-code-mode: lisp-mode; -*-% ===> this file was generated automatically by noweave --- better not edit it
\documentclass{tufte-book}
\usepackage{noweb}

\usepackage{color}
% https://commons.wikimedia.org/wiki/File:Erlang_logo.svg
\definecolor{ErlangRed}{HTML}{A90533}

\usepackage{hyperref}
\hypersetup{
  bookmarks=true,
  pdffitwindow=true,
  pdfstartview={FitH},
  pdftitle={PAIP Exercises},
  pdfauthor={Eric Bailey <eric@ericb.me>},
  pdfsubject={Paradigms of Artificial Intelligence Programming},
  pdfkeywords={Lisp, artificial intelligence, literate programming, noweb},
  colorlinks=true,
  linkcolor=ErlangRed,
  urlcolor=ErlangRed
}

\usepackage{amsmath}
\usepackage{amssymb}

\usepackage[outputdir=src/paip]{minted}

% NOTE: Use Tufte instead of noweb page style.
% \pagestyle{noweb}
% NOTE: Use shift option for wide code.
\noweboptions{smallcode,shortxref,webnumbering,english}

\title{PAIP Exercises}

\author{Eric Bailey}

% \date{January 23, 2017}

\newcommand{\stylehook}{\marginpar{\raggedright\sl Style hook}}

\newmintinline[lsp]{lisp}{}

\begin{document}
\maketitle
\nwfilename{src/paip/paip.nw}\nwbegindocs{1}\nwdocspar

\tableofcontents
\newpage

\chapter{Introduction to Common Lisp}

\section{Using Functions}

\nwenddocs{}\nwbegincode{2}\sublabel{NW192eu0-BpWdi-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-BpWdi-1}}}\moddef{titles~{\nwtagstyle{}\subpageref{NW192eu0-BpWdi-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2wUDG5-1}}\nwenddeflinemarkup
(defparameter \nwlinkedidentc{*titles*}{NW192eu0-BpWdi-1}
  '(Mr Mrs Miss Ms Sir Madam Dr Admiral Major General)
  "A list of titles that can appear at the start of a name.")
\nwindexdefn{\nwixident{*titles*}}{*titles*}{NW192eu0-BpWdi-1}\eatline
\nwused{\\{NW192eu0-2wUDG5-1}}\nwidentdefs{\\{{\nwixident{*titles*}}{*titles*}}}\nwendcode{}\nwbegindocs{3}\nwdocspar
\nwenddocs{}\nwbegincode{4}\sublabel{NW192eu0-1xnn0Z-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1xnn0Z-1}}}\moddef{abstract first-name~{\nwtagstyle{}\subpageref{NW192eu0-1xnn0Z-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(\LA{}function first-name(name):~{\nwtagstyle{}\subpageref{NW192eu0-4ONS4K-1}}\RA{}
  (\LA{}if the first element of name is a title~{\nwtagstyle{}\subpageref{NW192eu0-Ix42V-1}}\RA{}
    \LA{}then return the first-name of the rest of the name~{\nwtagstyle{}\subpageref{NW192eu0-2nVNHx-1}}\RA{}
    \LA{}else return the first element of the name~{\nwtagstyle{}\subpageref{NW192eu0-16R8JG-1}}\RA{}))
\nwnotused{abstract first-name}\nwendcode{}\nwbegindocs{5}\nwdocspar

\nwenddocs{}\nwbegincode{6}\sublabel{NW192eu0-4ONS4K-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-4ONS4K-1}}}\moddef{function first-name(name):~{\nwtagstyle{}\subpageref{NW192eu0-4ONS4K-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-1xnn0Z-1}}\nwenddeflinemarkup
defun first-name (name)
 "Select the first name from a name represented as a list."
\nwused{\\{NW192eu0-1xnn0Z-1}}\nwendcode{}\nwbegindocs{7}\nwdocspar

\nwenddocs{}\nwbegincode{8}\sublabel{NW192eu0-Ix42V-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-Ix42V-1}}}\moddef{if the first element of name is a title~{\nwtagstyle{}\subpageref{NW192eu0-Ix42V-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-1xnn0Z-1}}\nwenddeflinemarkup
if (member (first name) \nwlinkedidentc{*titles*}{NW192eu0-BpWdi-1})
\nwused{\\{NW192eu0-1xnn0Z-1}}\nwidentuses{\\{{\nwixident{*titles*}}{*titles*}}}\nwindexuse{\nwixident{*titles*}}{*titles*}{NW192eu0-Ix42V-1}\nwendcode{}\nwbegindocs{9}\nwdocspar

\nwenddocs{}\nwbegincode{10}\sublabel{NW192eu0-2nVNHx-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2nVNHx-1}}}\moddef{then return the first-name of the rest of the name~{\nwtagstyle{}\subpageref{NW192eu0-2nVNHx-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-1xnn0Z-1}}\nwenddeflinemarkup
  (first-name (rest name))
\nwused{\\{NW192eu0-1xnn0Z-1}}\nwendcode{}\nwbegindocs{11}\nwdocspar

\nwenddocs{}\nwbegincode{12}\sublabel{NW192eu0-16R8JG-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-16R8JG-1}}}\moddef{else return the first element of the name~{\nwtagstyle{}\subpageref{NW192eu0-16R8JG-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-1xnn0Z-1}}\nwenddeflinemarkup
(first name)
\nwused{\\{NW192eu0-1xnn0Z-1}}\nwendcode{}\nwbegindocs{13}\nwdocspar

\section{Exercises}

\nwenddocs{}\nwbegincode{14}\sublabel{NW192eu0-2wUDG5-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2wUDG5-1}}}\moddef{intro.lisp~{\nwtagstyle{}\subpageref{NW192eu0-2wUDG5-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(ql:quickload :lisp-unit)

(defpackage #:intro
  (:use #:common-lisp #:lisp-unit))

(in-package #:intro)

\LA{}titles~{\nwtagstyle{}\subpageref{NW192eu0-BpWdi-1}}\RA{}

;; Exercise 1.1
\LA{}Exercise 1.1~{\nwtagstyle{}\subpageref{NW192eu0-4Wuo2N-1}}\RA{}

;; Exercise 1.2
\LA{}Exercise 1.2~{\nwtagstyle{}\subpageref{NW192eu0-2DHmDj-1}}\RA{}

;; Exercise 1.3
\LA{}Exercise 1.3~{\nwtagstyle{}\subpageref{NW192eu0-2b8599-1}}\RA{}
\nwnotused{intro.lisp}\nwendcode{}\nwbegindocs{15}\nwdocspar

\subsection{Exercise 1.1}

\begin{quote}
  Define a version of {\Tt{}\nwlinkedidentq{last-name}{NW192eu0-4Zlwoj-1}\nwendquote} that handles ``Rex Morgan MD,'' ``Morton
  Downey, Jr.,'' and whatever other cases you can think of.
\end{quote}

\nwenddocs{}\nwbegincode{16}\sublabel{NW192eu0-4Wuo2N-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-4Wuo2N-1}}}\moddef{Exercise 1.1~{\nwtagstyle{}\subpageref{NW192eu0-4Wuo2N-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2wUDG5-1}}\nwenddeflinemarkup
\LA{}suffixes~{\nwtagstyle{}\subpageref{NW192eu0-33GIZY-1}}\RA{}

\LA{}last-name~{\nwtagstyle{}\subpageref{NW192eu0-4Zlwoj-1}}\RA{}

\LA{}Exercise 1.1 tests~{\nwtagstyle{}\subpageref{NW192eu0-29KvuZ-1}}\RA{}
\nwused{\\{NW192eu0-2wUDG5-1}}\nwendcode{}\nwbegindocs{17}\nwdocspar

\nwenddocs{}\nwbegincode{18}\sublabel{NW192eu0-4Zlwoj-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-4Zlwoj-1}}}\moddef{last-name~{\nwtagstyle{}\subpageref{NW192eu0-4Zlwoj-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-4Wuo2N-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{last-name}{NW192eu0-4Zlwoj-1} (name)\nwindexdefn{\nwixident{last-name}}{last-name}{NW192eu0-4Zlwoj-1}
  "Select the last name from a name represented as a list."
  (if \LA{}the last element of a name is a suffix~{\nwtagstyle{}\subpageref{NW192eu0-2t3lxE-1}}\RA{}
      \LA{}then return the \code{}last-name\edoc{} of all but the last element of the name~{\nwtagstyle{}\subpageref{NW192eu0-3W6gHs-1}}\RA{}
    \LA{}else return the last element of the name~{\nwtagstyle{}\subpageref{NW192eu0-2NIVBh-1}}\RA{}))
\nwused{\\{NW192eu0-4Wuo2N-1}}\nwidentdefs{\\{{\nwixident{last-name}}{last-name}}}\nwendcode{}\nwbegindocs{19}\nwdocspar

First, we check to see if the last element of the \lsp{name} is a suffix, i.e.
whether it's a member of {\Tt{}\nwlinkedidentq{*suffixes*}{NW192eu0-33GIZY-1}\nwendquote}.
\nwenddocs{}\nwbegincode{20}\sublabel{NW192eu0-2t3lxE-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2t3lxE-1}}}\moddef{the last element of a name is a suffix~{\nwtagstyle{}\subpageref{NW192eu0-2t3lxE-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-4Zlwoj-1}}\nwenddeflinemarkup
(member (first (last name)) \nwlinkedidentc{*suffixes*}{NW192eu0-33GIZY-1})
\nwused{\\{NW192eu0-4Zlwoj-1}}\nwidentuses{\\{{\nwixident{*suffixes*}}{*suffixes*}}}\nwindexuse{\nwixident{*suffixes*}}{*suffixes*}{NW192eu0-2t3lxE-1}\nwendcode{}\nwbegindocs{21}\nwdocspar

If it is, then drop it from the \lsp{name} and return the {\Tt{}\nwlinkedidentq{last-name}{NW192eu0-4Zlwoj-1}\nwendquote} of the
result.
\nwenddocs{}\nwbegincode{22}\sublabel{NW192eu0-3W6gHs-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-3W6gHs-1}}}\moddef{then return the \code{}last-name\edoc{} of all but the last element of the name~{\nwtagstyle{}\subpageref{NW192eu0-3W6gHs-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-4Zlwoj-1}}\nwenddeflinemarkup
(\nwlinkedidentc{last-name}{NW192eu0-4Zlwoj-1} (butlast name))
\nwused{\\{NW192eu0-4Zlwoj-1}}\nwidentuses{\\{{\nwixident{last-name}}{last-name}}}\nwindexuse{\nwixident{last-name}}{last-name}{NW192eu0-3W6gHs-1}\nwendcode{}\nwbegindocs{23}\nwdocspar

Otherwise, it's the last name, so return it.
\nwenddocs{}\nwbegincode{24}\sublabel{NW192eu0-2NIVBh-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2NIVBh-1}}}\moddef{else return the last element of the name~{\nwtagstyle{}\subpageref{NW192eu0-2NIVBh-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-4Zlwoj-1}}\nwenddeflinemarkup
(first (last name))
\nwused{\\{NW192eu0-4Zlwoj-1}}\nwendcode{}\nwbegindocs{25}\nwdocspar

\nwenddocs{}\nwbegincode{26}\sublabel{NW192eu0-33GIZY-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-33GIZY-1}}}\moddef{suffixes~{\nwtagstyle{}\subpageref{NW192eu0-33GIZY-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-4Wuo2N-1}}\nwenddeflinemarkup
(defparameter \nwlinkedidentc{*suffixes*}{NW192eu0-33GIZY-1}
  '(MD Jr)
  "A list of suffixes that can appear at the end of a name.")
\nwindexdefn{\nwixident{*suffixes*}}{*suffixes*}{NW192eu0-33GIZY-1}\eatline
\nwused{\\{NW192eu0-4Wuo2N-1}}\nwidentdefs{\\{{\nwixident{*suffixes*}}{*suffixes*}}}\nwendcode{}\nwbegindocs{27}\nwdocspar
\nwenddocs{}\nwbegincode{28}\sublabel{NW192eu0-29KvuZ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-29KvuZ-1}}}\moddef{Exercise 1.1 tests~{\nwtagstyle{}\subpageref{NW192eu0-29KvuZ-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-4Wuo2N-1}}\nwenddeflinemarkup
(define-test test-last-name
  \LA{}Rex Morgan MD~{\nwtagstyle{}\subpageref{NW192eu0-1iWMbJ-1}}\RA{}
  \LA{}Morton Downey, Jr~{\nwtagstyle{}\subpageref{NW192eu0-189ElO-1}}\RA{})
\nwused{\\{NW192eu0-4Wuo2N-1}}\nwendcode{}\nwbegindocs{29}\nwdocspar

\marginnote[\baselineskip]{
  Assert that the {\Tt{}\nwlinkedidentq{last-name}{NW192eu0-4Zlwoj-1}\nwendquote} of {\sl Rex Morgan MD} is {\sl Morgan}.
}
\nwenddocs{}\nwbegincode{30}\sublabel{NW192eu0-1iWMbJ-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1iWMbJ-1}}}\moddef{Rex Morgan MD~{\nwtagstyle{}\subpageref{NW192eu0-1iWMbJ-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-29KvuZ-1}}\nwenddeflinemarkup
(assert-equal 'Morgan (\nwlinkedidentc{last-name}{NW192eu0-4Zlwoj-1} '(Rex Morgan MD)))
\nwused{\\{NW192eu0-29KvuZ-1}}\nwidentuses{\\{{\nwixident{last-name}}{last-name}}}\nwindexuse{\nwixident{last-name}}{last-name}{NW192eu0-1iWMbJ-1}\nwendcode{}\nwbegindocs{31}\nwdocspar

\nwenddocs{}\nwbegincode{32}\sublabel{NW192eu0-189ElO-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-189ElO-1}}}\moddef{Morton Downey, Jr~{\nwtagstyle{}\subpageref{NW192eu0-189ElO-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-29KvuZ-1}}\nwenddeflinemarkup
(assert-equal 'Downey (\nwlinkedidentc{last-name}{NW192eu0-4Zlwoj-1} '(Morton Downey Jr)))
\nwused{\\{NW192eu0-29KvuZ-1}}\nwidentuses{\\{{\nwixident{last-name}}{last-name}}}\nwindexuse{\nwixident{last-name}}{last-name}{NW192eu0-189ElO-1}\nwendcode{}\nwbegindocs{33}\nwdocspar

\subsection{Exercise 1.2}

\begin{quote}
  Write a function to exponentiate, or raise a number to an integer power. For
  example \lsp{(}{\Tt{}\nwlinkedidentq{power}{NW192eu0-3kZCB2-1}\nwendquote}\lsp{ 3 2)} $= 3^2 = 9$.
\end{quote}

\nwenddocs{}\nwbegincode{34}\sublabel{NW192eu0-2DHmDj-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2DHmDj-1}}}\moddef{Exercise 1.2~{\nwtagstyle{}\subpageref{NW192eu0-2DHmDj-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2wUDG5-1}}\nwenddeflinemarkup
\LA{}square~{\nwtagstyle{}\subpageref{NW192eu0-3NPSQP-1}}\RA{}

\LA{}power~{\nwtagstyle{}\subpageref{NW192eu0-3kZCB2-1}}\RA{}

\LA{}Exercise 1.2 tests~{\nwtagstyle{}\subpageref{NW192eu0-Nfd08-1}}\RA{}
\nwused{\\{NW192eu0-2wUDG5-1}}\nwendcode{}\nwbegindocs{35}\nwdocspar

\marginnote[2.5\baselineskip]{
  \begin{align*}
    x^n = \begin{cases}
      1 & \text{if } n = 0, \\
      (x^{n / 2})^2 & \text{if } n \text{ is even}, \\
      x \times x^{n - 1} & \text{otherwise}.
    \end{cases}
  \end{align*}
}
\nwenddocs{}\nwbegincode{36}\sublabel{NW192eu0-3kZCB2-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-3kZCB2-1}}}\moddef{power~{\nwtagstyle{}\subpageref{NW192eu0-3kZCB2-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2DHmDj-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{power}{NW192eu0-3kZCB2-1} (x n)\nwindexdefn{\nwixident{power}}{power}{NW192eu0-3kZCB2-1}
  "Raise x to the \nwlinkedidentc{power}{NW192eu0-3kZCB2-1} of n."
  (cond \LA{}if n is zero return 1~{\nwtagstyle{}\subpageref{NW192eu0-2y88rI-1}}\RA{}
        \LA{}if n is even return x to the power of n over two, squared~{\nwtagstyle{}\subpageref{NW192eu0-3Slm34-1}}\RA{}
        \LA{}otherwise return x times x to the power of n minus one~{\nwtagstyle{}\subpageref{NW192eu0-1kE0RF-1}}\RA{}))
\nwused{\\{NW192eu0-2DHmDj-1}}\nwidentdefs{\\{{\nwixident{power}}{power}}}\nwendcode{}\nwbegindocs{37}\nwdocspar

\marginnote[\baselineskip]{$x^0 = 1$}
\nwenddocs{}\nwbegincode{38}\sublabel{NW192eu0-2y88rI-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2y88rI-1}}}\moddef{if n is zero return 1~{\nwtagstyle{}\subpageref{NW192eu0-2y88rI-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-3kZCB2-1}}\nwenddeflinemarkup
((zerop n) 1)
\nwused{\\{NW192eu0-3kZCB2-1}}\nwendcode{}\nwbegindocs{39}\nwdocspar

\nwenddocs{}\nwbegincode{40}\sublabel{NW192eu0-3Slm34-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-3Slm34-1}}}\moddef{if n is even return x to the power of n over two, squared~{\nwtagstyle{}\subpageref{NW192eu0-3Slm34-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-3kZCB2-1}}\nwenddeflinemarkup
((evenp n) (\nwlinkedidentc{square}{NW192eu0-3NPSQP-1} (\nwlinkedidentc{power}{NW192eu0-3kZCB2-1} x (/ n 2))))
\nwused{\\{NW192eu0-3kZCB2-1}}\nwidentuses{\\{{\nwixident{power}}{power}}\\{{\nwixident{square}}{square}}}\nwindexuse{\nwixident{power}}{power}{NW192eu0-3Slm34-1}\nwindexuse{\nwixident{square}}{square}{NW192eu0-3Slm34-1}\nwendcode{}\nwbegindocs{41}\nwdocspar

\nwenddocs{}\nwbegincode{42}\sublabel{NW192eu0-1kE0RF-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1kE0RF-1}}}\moddef{otherwise return x times x to the power of n minus one~{\nwtagstyle{}\subpageref{NW192eu0-1kE0RF-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-3kZCB2-1}}\nwenddeflinemarkup
(t (* x (\nwlinkedidentc{power}{NW192eu0-3kZCB2-1} x (- n 1))))
\nwused{\\{NW192eu0-3kZCB2-1}}\nwidentuses{\\{{\nwixident{power}}{power}}}\nwindexuse{\nwixident{power}}{power}{NW192eu0-1kE0RF-1}\nwendcode{}\nwbegindocs{43}\nwdocspar

\marginnote[\baselineskip]{$\text{square}(x) = x^2$}
\nwenddocs{}\nwbegincode{44}\sublabel{NW192eu0-3NPSQP-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-3NPSQP-1}}}\moddef{square~{\nwtagstyle{}\subpageref{NW192eu0-3NPSQP-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2DHmDj-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{square}{NW192eu0-3NPSQP-1} (x) (expt x 2))\nwindexdefn{\nwixident{square}}{square}{NW192eu0-3NPSQP-1}
\nwused{\\{NW192eu0-2DHmDj-1}}\nwidentdefs{\\{{\nwixident{square}}{square}}}\nwendcode{}\nwbegindocs{45}\nwdocspar

\nwenddocs{}\nwbegincode{46}\sublabel{NW192eu0-Nfd08-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-Nfd08-1}}}\moddef{Exercise 1.2 tests~{\nwtagstyle{}\subpageref{NW192eu0-Nfd08-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2DHmDj-1}}\nwenddeflinemarkup
(define-test test-power
  (assert-equal 9 (\nwlinkedidentc{power}{NW192eu0-3kZCB2-1} 3 2)))
\nwused{\\{NW192eu0-2DHmDj-1}}\nwidentuses{\\{{\nwixident{power}}{power}}}\nwindexuse{\nwixident{power}}{power}{NW192eu0-Nfd08-1}\nwendcode{}\nwbegindocs{47}\nwdocspar

\subsection{Exercise 1.3}

\begin{quote}
  Write a function that counts the number of atoms in an expression. For
  example: \lsp{(}{\Tt{}\nwlinkedidentq{count-atoms}{NW192eu0-2b8599-1}\nwendquote}\lsp{ '(a (b) c))} $= 3$. Notice that there is
  something of an ambiguity in this: should \lsp{(a nil c)} count as three
  atoms, or as two, because it is equivalent to \lsp{(a () c)}?
\end{quote}

\nwenddocs{}\nwbegincode{48}\sublabel{NW192eu0-2b8599-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2b8599-1}}}\moddef{Exercise 1.3~{\nwtagstyle{}\subpageref{NW192eu0-2b8599-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2wUDG5-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{count-atoms}{NW192eu0-2b8599-1} (exp)\nwindexdefn{\nwixident{count-atoms}}{count-atoms}{NW192eu0-2b8599-1}
  "Return the total number of non-nil atoms in the expression."
  (cond \LA{}if exp is nil there are no atoms~{\nwtagstyle{}\subpageref{NW192eu0-2dHnrc-1}}\RA{}
        \LA{}if exp is an atom there is only one~{\nwtagstyle{}\subpageref{NW192eu0-20ij8Y-1}}\RA{}
        \LA{}otherwise add the count of the atoms in the first and rest of exp~{\nwtagstyle{}\subpageref{NW192eu0-44AOMF-1}}\RA{}))
\nwused{\\{NW192eu0-2wUDG5-1}}\nwidentdefs{\\{{\nwixident{count-atoms}}{count-atoms}}}\nwendcode{}\nwbegindocs{49}\nwdocspar

\nwenddocs{}\nwbegincode{50}\sublabel{NW192eu0-2dHnrc-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2dHnrc-1}}}\moddef{if exp is nil there are no atoms~{\nwtagstyle{}\subpageref{NW192eu0-2dHnrc-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2b8599-1}}\nwenddeflinemarkup
((null exp) 0)
\nwused{\\{NW192eu0-2b8599-1}}\nwendcode{}\nwbegindocs{51}\nwdocspar

\nwenddocs{}\nwbegincode{52}\sublabel{NW192eu0-20ij8Y-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-20ij8Y-1}}}\moddef{if exp is an atom there is only one~{\nwtagstyle{}\subpageref{NW192eu0-20ij8Y-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2b8599-1}}\nwenddeflinemarkup
((atom exp) 1)
\nwused{\\{NW192eu0-2b8599-1}}\nwendcode{}\nwbegindocs{53}\nwdocspar

\nwenddocs{}\nwbegincode{54}\sublabel{NW192eu0-44AOMF-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-44AOMF-1}}}\moddef{otherwise add the count of the atoms in the first and rest of exp~{\nwtagstyle{}\subpageref{NW192eu0-44AOMF-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2b8599-1}}\nwenddeflinemarkup
(t (+ (\nwlinkedidentc{count-atoms}{NW192eu0-2b8599-1} (first exp))
      (\nwlinkedidentc{count-atoms}{NW192eu0-2b8599-1} (rest exp))))
\nwused{\\{NW192eu0-2b8599-1}}\nwidentuses{\\{{\nwixident{count-atoms}}{count-atoms}}}\nwindexuse{\nwixident{count-atoms}}{count-atoms}{NW192eu0-44AOMF-1}\nwendcode{}\nwbegindocs{55}\nwdocspar

\chapter{Overview of Lisp}

\nwenddocs{}\nwbegincode{56}\sublabel{NW192eu0-3sUrxR-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-3sUrxR-1}}}\moddef{find-all~{\nwtagstyle{}\subpageref{NW192eu0-3sUrxR-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{find-all}{NW192eu0-3sUrxR-1} (item sequence &rest keyword-args\nwindexdefn{\nwixident{find-all}}{find-all}{NW192eu0-3sUrxR-1}
                 &key (test #'eql) test-not &allow-other-keys)
  "Find all those elements of sequence that match item,
  according to the keywords. Doesn't alter sequence."
  (if test-not
      (apply #'remove item sequence
             :test-not (complement test-not) keyword-args)
      (apply #'remove item sequence
             :test (complement test) keyword-args)))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{find-all}}{find-all}}}\nwendcode{}\nwbegindocs{57}\nwdocspar


\chapter{GPS: The General Problem Solver}

\nwenddocs{}\nwbegincode{58}\sublabel{NW192eu0-2EtURf-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2EtURf-1}}}\moddef{gps.lisp~{\nwtagstyle{}\subpageref{NW192eu0-2EtURf-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
(ql:quickload :lisp-unit)

(defpackage #:gps
  (:use #:common-lisp #:lisp-unit)
  (:export #:\nwlinkedidentc{GPS}{NW192eu0-30p2tX-1}))

(in-package #:gps)

\LA{}find-all~{\nwtagstyle{}\subpageref{NW192eu0-3sUrxR-1}}\RA{}

\LA{}The current state: a list of conditions~{\nwtagstyle{}\subpageref{NW192eu0-1p9ITd-1}}\RA{}

\LA{}A list of available operators~{\nwtagstyle{}\subpageref{NW192eu0-1JBQVW-1}}\RA{}

\LA{}An operation with preconds, add-list and del-list~{\nwtagstyle{}\subpageref{NW192eu0-2hGwYk-1}}\RA{}

\LA{}Solve a goal from a state using a list of operators~{\nwtagstyle{}\subpageref{NW192eu0-30p2tX-1}}\RA{}

\LA{}Achieve an individual goal~{\nwtagstyle{}\subpageref{NW192eu0-1Tx3Kh-1}}\RA{}

\LA{}Decide if an operator is appropriate for a goal~{\nwtagstyle{}\subpageref{NW192eu0-ocPeo-1}}\RA{}

\LA{}Apply operator to current state~{\nwtagstyle{}\subpageref{NW192eu0-3nt6zV-1}}\RA{}

\LA{}Define a list of operations~{\nwtagstyle{}\subpageref{NW192eu0-EYzBW-1}}\RA{}

\LA{}Assert that a given problem is solvable~{\nwtagstyle{}\subpageref{NW192eu0-1OSqox-1}}\RA{}

\LA{}GPS Tests~{\nwtagstyle{}\subpageref{NW192eu0-1ahSlC-1}}\RA{}
\nwnotused{gps.lisp}\nwidentuses{\\{{\nwixident{GPS}}{GPS}}}\nwindexuse{\nwixident{GPS}}{GPS}{NW192eu0-2EtURf-1}\nwendcode{}\nwbegindocs{59}\nwdocspar

\nwenddocs{}\nwbegincode{60}\sublabel{NW192eu0-1p9ITd-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1p9ITd-1}}}\moddef{The current state: a list of conditions~{\nwtagstyle{}\subpageref{NW192eu0-1p9ITd-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defvar \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} nil "The current state: a list of conditions.")\nwindexdefn{\nwixident{*state*}}{*state*}{NW192eu0-1p9ITd-1}
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{*state*}}{*state*}}}\nwendcode{}\nwbegindocs{61}\nwdocspar

\nwenddocs{}\nwbegincode{62}\sublabel{NW192eu0-1JBQVW-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1JBQVW-1}}}\moddef{A list of available operators~{\nwtagstyle{}\subpageref{NW192eu0-1JBQVW-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defvar \nwlinkedidentc{*ops*}{NW192eu0-1JBQVW-1} nil "A list of available operators.")\nwindexdefn{\nwixident{*ops*}}{*ops*}{NW192eu0-1JBQVW-1}
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{*ops*}}{*ops*}}}\nwendcode{}\nwbegindocs{63}\nwdocspar

\nwenddocs{}\nwbegincode{64}\sublabel{NW192eu0-2hGwYk-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-2hGwYk-1}}}\moddef{An operation with preconds, add-list and del-list~{\nwtagstyle{}\subpageref{NW192eu0-2hGwYk-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defstruct op
  "An operation"
  (action nil)
  (preconds nil)
  (add-list nil)
  (del-list nil))
\nwused{\\{NW192eu0-2EtURf-1}}\nwendcode{}\nwbegindocs{65}\nwdocspar

\nwenddocs{}\nwbegincode{66}\sublabel{NW192eu0-30p2tX-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-30p2tX-1}}}\moddef{Solve a goal from a state using a list of operators~{\nwtagstyle{}\subpageref{NW192eu0-30p2tX-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{GPS}{NW192eu0-30p2tX-1} (\nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} goals \nwlinkedidentc{*ops*}{NW192eu0-1JBQVW-1})\nwindexdefn{\nwixident{GPS}}{GPS}{NW192eu0-30p2tX-1}
  "General Problem Solver: \nwlinkedidentc{achieve}{NW192eu0-1Tx3Kh-1} all goals using *ops*."
  (if (every #'\nwlinkedidentc{achieve}{NW192eu0-1Tx3Kh-1} goals) 'solved))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{GPS}}{GPS}}}\nwidentuses{\\{{\nwixident{*ops*}}{*ops*}}\\{{\nwixident{*state*}}{*state*}}\\{{\nwixident{achieve}}{achieve}}}\nwindexuse{\nwixident{*ops*}}{*ops*}{NW192eu0-30p2tX-1}\nwindexuse{\nwixident{*state*}}{*state*}{NW192eu0-30p2tX-1}\nwindexuse{\nwixident{achieve}}{achieve}{NW192eu0-30p2tX-1}\nwendcode{}\nwbegindocs{67}\nwdocspar

\nwenddocs{}\nwbegincode{68}\sublabel{NW192eu0-1Tx3Kh-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1Tx3Kh-1}}}\moddef{Achieve an individual goal~{\nwtagstyle{}\subpageref{NW192eu0-1Tx3Kh-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{achieve}{NW192eu0-1Tx3Kh-1} (goal)\nwindexdefn{\nwixident{achieve}}{achieve}{NW192eu0-1Tx3Kh-1}
  "A goal is achieved if it already holds,
  or if there is an appropriate op for it that is applicable."
  (or (member goal \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1})
      (some #'\nwlinkedidentc{apply-op}{NW192eu0-3nt6zV-1}
            (\nwlinkedidentc{find-all}{NW192eu0-3sUrxR-1} goal \nwlinkedidentc{*ops*}{NW192eu0-1JBQVW-1} :test #'\nwlinkedidentc{appropriate-p}{NW192eu0-ocPeo-1}))))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{achieve}}{achieve}}}\nwidentuses{\\{{\nwixident{*ops*}}{*ops*}}\\{{\nwixident{*state*}}{*state*}}\\{{\nwixident{apply-op}}{apply-op}}\\{{\nwixident{appropriate-p}}{appropriate-p}}\\{{\nwixident{find-all}}{find-all}}}\nwindexuse{\nwixident{*ops*}}{*ops*}{NW192eu0-1Tx3Kh-1}\nwindexuse{\nwixident{*state*}}{*state*}{NW192eu0-1Tx3Kh-1}\nwindexuse{\nwixident{apply-op}}{apply-op}{NW192eu0-1Tx3Kh-1}\nwindexuse{\nwixident{appropriate-p}}{appropriate-p}{NW192eu0-1Tx3Kh-1}\nwindexuse{\nwixident{find-all}}{find-all}{NW192eu0-1Tx3Kh-1}\nwendcode{}\nwbegindocs{69}\nwdocspar

\nwenddocs{}\nwbegincode{70}\sublabel{NW192eu0-ocPeo-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-ocPeo-1}}}\moddef{Decide if an operator is appropriate for a goal~{\nwtagstyle{}\subpageref{NW192eu0-ocPeo-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{appropriate-p}{NW192eu0-ocPeo-1} (goal op)\nwindexdefn{\nwixident{appropriate-p}}{appropriate-p}{NW192eu0-ocPeo-1}
  "An op is appropriate to a goal if it is in its add list."
  (member goal (op-add-list op)))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{appropriate-p}}{appropriate-p}}}\nwendcode{}\nwbegindocs{71}\nwdocspar

\nwenddocs{}\nwbegincode{72}\sublabel{NW192eu0-3nt6zV-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-3nt6zV-1}}}\moddef{Apply operator to current state~{\nwtagstyle{}\subpageref{NW192eu0-3nt6zV-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defun \nwlinkedidentc{apply-op}{NW192eu0-3nt6zV-1} (op)\nwindexdefn{\nwixident{apply-op}}{apply-op}{NW192eu0-3nt6zV-1}
  "Print a message and update \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} if op is applicable."
  (when (every #'\nwlinkedidentc{achieve}{NW192eu0-1Tx3Kh-1} (op-preconds op))
    (print (list 'executing (op-action op)))
    (setf \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} (set-difference \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} (op-del-list op)))
    (setf \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} (union \nwlinkedidentc{*state*}{NW192eu0-1p9ITd-1} (op-add-list op)))
    t))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{apply-op}}{apply-op}}}\nwidentuses{\\{{\nwixident{*state*}}{*state*}}\\{{\nwixident{achieve}}{achieve}}}\nwindexuse{\nwixident{*state*}}{*state*}{NW192eu0-3nt6zV-1}\nwindexuse{\nwixident{achieve}}{achieve}{NW192eu0-3nt6zV-1}\nwendcode{}\nwbegindocs{73}\nwdocspar

To drive the son to school, the son must start at home and the car must work.
\nwenddocs{}\nwbegincode{74}\sublabel{NW192eu0-31LYLP-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-31LYLP-1}}}\moddef{Drive son to school~{\nwtagstyle{}\subpageref{NW192eu0-31LYLP-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-EYzBW-1}}\nwenddeflinemarkup
(make-op :action 'drive-son-to-school
         :preconds '(son-at-home car-works)
         :add-list '(son-at-school)
         :del-list '(son-at-home))
\nwused{\\{NW192eu0-EYzBW-1}}\nwendcode{}\nwbegindocs{75}\nwdocspar

\nwenddocs{}\nwbegincode{76}\sublabel{NW192eu0-EYzBW-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-EYzBW-1}}}\moddef{Define a list of operations~{\nwtagstyle{}\subpageref{NW192eu0-EYzBW-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defparameter *school-ops*
  (list
   \LA{}Drive son to school~{\nwtagstyle{}\subpageref{NW192eu0-31LYLP-1}}\RA{}
   (make-op :action 'shop-installs-battery
            :preconds '(car-needs-battery shop-knows-problem shop-has-money)
            :add-list '(car-works))
   (make-op :action 'tell-shop-problem
            :preconds '(in-communication-with-shop)
            :add-list '(shop-knows-problem))
   (make-op :action 'telephone-shop
            :preconds '(know-phone-number)
            :add-list '(in-communication-with-shop))
   (make-op :action 'look-up-number
            :preconds '(have-phone-book)
            :add-list '(know-phone-number))
   (make-op :action 'give-shop-money
            :preconds '(have-money)
            :add-list '(shop-has-money)
            :del-list '(have-money))))
\nwused{\\{NW192eu0-2EtURf-1}}\nwendcode{}\nwbegindocs{77}\nwdocspar

\section{Tests}
\nwenddocs{}\nwbegincode{78}\sublabel{NW192eu0-1OSqox-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1OSqox-1}}}\moddef{Assert that a given problem is solvable~{\nwtagstyle{}\subpageref{NW192eu0-1OSqox-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(defmacro \nwlinkedidentc{assert-solved}{NW192eu0-1OSqox-1} (form)\nwindexdefn{\nwixident{assert-solved}}{assert-solved}{NW192eu0-1OSqox-1}
  `(assert-equal 'solved ,form))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentdefs{\\{{\nwixident{assert-solved}}{assert-solved}}}\nwendcode{}\nwbegindocs{79}\nwdocspar

\nwenddocs{}\nwbegincode{80}\sublabel{NW192eu0-1ahSlC-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-1ahSlC-1}}}\moddef{GPS Tests~{\nwtagstyle{}\subpageref{NW192eu0-1ahSlC-1}}}\endmoddef\nwstartdeflinemarkup\nwusesondefline{\\{NW192eu0-2EtURf-1}}\nwenddeflinemarkup
(define-test complex
  (assert-equal
   (format nil "~%~\{(EXECUTING ~A) ~^~%~\}"
           '(look-up-number
             telephone-shop
             tell-shop-problem
             give-shop-money
             shop-installs-battery
             drive-son-to-school))
   (with-output-to-string (*standard-output*)
     (\nwlinkedidentc{assert-solved}{NW192eu0-1OSqox-1}
      (gps '(son-at-home car-needs-battery have-money have-phone-book)
           '(son-at-school)
           *school-ops*)))))

(define-test unsolvable
  (assert-nil (gps '(son-at-home car-needs-battery have-money)
                   '(son-at-school)
                   *school-ops*)))

(define-test simple
  (\nwlinkedidentc{assert-solved}{NW192eu0-1OSqox-1} (gps '(son-at-home car-works)
                      '(son-at-school)
                      *school-ops*)))

(define-test money-leftover
  (\nwlinkedidentc{assert-solved}{NW192eu0-1OSqox-1} (gps '(son-at-home have-money car-works)
                      '(have-money son-at-school)
                      *school-ops*)))

(define-test clobbered-sibling
  (assert-nil (gps '(son-at-home car-needs-battery have-money have-phone-book)
                   '(have-money son-at-school)
                   *school-ops*)))
\nwused{\\{NW192eu0-2EtURf-1}}\nwidentuses{\\{{\nwixident{assert-solved}}{assert-solved}}}\nwindexuse{\nwixident{assert-solved}}{assert-solved}{NW192eu0-1ahSlC-1}\nwendcode{}\nwbegindocs{81}\nwdocspar

\chapter{Test Runner}

\nwenddocs{}\nwbegincode{82}\sublabel{NW192eu0-i0Dup-1}\nwmargintag{{\nwtagstyle{}\subpageref{NW192eu0-i0Dup-1}}}\moddef{runtests~{\nwtagstyle{}\subpageref{NW192eu0-i0Dup-1}}}\endmoddef\nwstartdeflinemarkup\nwenddeflinemarkup
#! /usr/bin/env nix-shell
#! nix-shell -i sh -p sbcl

# N.B. quicklisp must be installed and configured.

sbcl --non-interactive \\
     --load src/paip/$1.lisp \\
     --eval "(let* ((results (lisp-unit:run-tests :all :$1))
                    (failures (lisp-unit:failed-tests results))
                    (status   (if (null failures) 0 1)))
               (sb-posix:exit status))"
\nwnotused{runtests}\nwendcode{}

\nwixlogsorted{c}{{A list of available operators}{NW192eu0-1JBQVW-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-1JBQVW-1}}}%
\nwixlogsorted{c}{{abstract first-name}{NW192eu0-1xnn0Z-1}{\nwixd{NW192eu0-1xnn0Z-1}}}%
\nwixlogsorted{c}{{Achieve an individual goal}{NW192eu0-1Tx3Kh-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-1Tx3Kh-1}}}%
\nwixlogsorted{c}{{An operation with preconds, add-list and del-list}{NW192eu0-2hGwYk-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-2hGwYk-1}}}%
\nwixlogsorted{c}{{Apply operator to current state}{NW192eu0-3nt6zV-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-3nt6zV-1}}}%
\nwixlogsorted{c}{{Assert that a given problem is solvable}{NW192eu0-1OSqox-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-1OSqox-1}}}%
\nwixlogsorted{c}{{Decide if an operator is appropriate for a goal}{NW192eu0-ocPeo-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-ocPeo-1}}}%
\nwixlogsorted{c}{{Define a list of operations}{NW192eu0-EYzBW-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-EYzBW-1}}}%
\nwixlogsorted{c}{{Drive son to school}{NW192eu0-31LYLP-1}{\nwixd{NW192eu0-31LYLP-1}\nwixu{NW192eu0-EYzBW-1}}}%
\nwixlogsorted{c}{{else return the first element of the name}{NW192eu0-16R8JG-1}{\nwixu{NW192eu0-1xnn0Z-1}\nwixd{NW192eu0-16R8JG-1}}}%
\nwixlogsorted{c}{{else return the last element of the name}{NW192eu0-2NIVBh-1}{\nwixu{NW192eu0-4Zlwoj-1}\nwixd{NW192eu0-2NIVBh-1}}}%
\nwixlogsorted{c}{{Exercise 1.1}{NW192eu0-4Wuo2N-1}{\nwixu{NW192eu0-2wUDG5-1}\nwixd{NW192eu0-4Wuo2N-1}}}%
\nwixlogsorted{c}{{Exercise 1.1 tests}{NW192eu0-29KvuZ-1}{\nwixu{NW192eu0-4Wuo2N-1}\nwixd{NW192eu0-29KvuZ-1}}}%
\nwixlogsorted{c}{{Exercise 1.2}{NW192eu0-2DHmDj-1}{\nwixu{NW192eu0-2wUDG5-1}\nwixd{NW192eu0-2DHmDj-1}}}%
\nwixlogsorted{c}{{Exercise 1.2 tests}{NW192eu0-Nfd08-1}{\nwixu{NW192eu0-2DHmDj-1}\nwixd{NW192eu0-Nfd08-1}}}%
\nwixlogsorted{c}{{Exercise 1.3}{NW192eu0-2b8599-1}{\nwixu{NW192eu0-2wUDG5-1}\nwixd{NW192eu0-2b8599-1}}}%
\nwixlogsorted{c}{{find-all}{NW192eu0-3sUrxR-1}{\nwixd{NW192eu0-3sUrxR-1}\nwixu{NW192eu0-2EtURf-1}}}%
\nwixlogsorted{c}{{function first-name(name):}{NW192eu0-4ONS4K-1}{\nwixu{NW192eu0-1xnn0Z-1}\nwixd{NW192eu0-4ONS4K-1}}}%
\nwixlogsorted{c}{{GPS Tests}{NW192eu0-1ahSlC-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-1ahSlC-1}}}%
\nwixlogsorted{c}{{gps.lisp}{NW192eu0-2EtURf-1}{\nwixd{NW192eu0-2EtURf-1}}}%
\nwixlogsorted{c}{{if exp is an atom there is only one}{NW192eu0-20ij8Y-1}{\nwixu{NW192eu0-2b8599-1}\nwixd{NW192eu0-20ij8Y-1}}}%
\nwixlogsorted{c}{{if exp is nil there are no atoms}{NW192eu0-2dHnrc-1}{\nwixu{NW192eu0-2b8599-1}\nwixd{NW192eu0-2dHnrc-1}}}%
\nwixlogsorted{c}{{if n is even return x to the power of n over two, squared}{NW192eu0-3Slm34-1}{\nwixu{NW192eu0-3kZCB2-1}\nwixd{NW192eu0-3Slm34-1}}}%
\nwixlogsorted{c}{{if n is zero return 1}{NW192eu0-2y88rI-1}{\nwixu{NW192eu0-3kZCB2-1}\nwixd{NW192eu0-2y88rI-1}}}%
\nwixlogsorted{c}{{if the first element of name is a title}{NW192eu0-Ix42V-1}{\nwixu{NW192eu0-1xnn0Z-1}\nwixd{NW192eu0-Ix42V-1}}}%
\nwixlogsorted{c}{{intro.lisp}{NW192eu0-2wUDG5-1}{\nwixd{NW192eu0-2wUDG5-1}}}%
\nwixlogsorted{c}{{last-name}{NW192eu0-4Zlwoj-1}{\nwixu{NW192eu0-4Wuo2N-1}\nwixd{NW192eu0-4Zlwoj-1}}}%
\nwixlogsorted{c}{{Morton Downey, Jr}{NW192eu0-189ElO-1}{\nwixu{NW192eu0-29KvuZ-1}\nwixd{NW192eu0-189ElO-1}}}%
\nwixlogsorted{c}{{otherwise add the count of the atoms in the first and rest of exp}{NW192eu0-44AOMF-1}{\nwixu{NW192eu0-2b8599-1}\nwixd{NW192eu0-44AOMF-1}}}%
\nwixlogsorted{c}{{otherwise return x times x to the power of n minus one}{NW192eu0-1kE0RF-1}{\nwixu{NW192eu0-3kZCB2-1}\nwixd{NW192eu0-1kE0RF-1}}}%
\nwixlogsorted{c}{{power}{NW192eu0-3kZCB2-1}{\nwixu{NW192eu0-2DHmDj-1}\nwixd{NW192eu0-3kZCB2-1}}}%
\nwixlogsorted{c}{{Rex Morgan MD}{NW192eu0-1iWMbJ-1}{\nwixu{NW192eu0-29KvuZ-1}\nwixd{NW192eu0-1iWMbJ-1}}}%
\nwixlogsorted{c}{{runtests}{NW192eu0-i0Dup-1}{\nwixd{NW192eu0-i0Dup-1}}}%
\nwixlogsorted{c}{{Solve a goal from a state using a list of operators}{NW192eu0-30p2tX-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-30p2tX-1}}}%
\nwixlogsorted{c}{{square}{NW192eu0-3NPSQP-1}{\nwixu{NW192eu0-2DHmDj-1}\nwixd{NW192eu0-3NPSQP-1}}}%
\nwixlogsorted{c}{{suffixes}{NW192eu0-33GIZY-1}{\nwixu{NW192eu0-4Wuo2N-1}\nwixd{NW192eu0-33GIZY-1}}}%
\nwixlogsorted{c}{{The current state: a list of conditions}{NW192eu0-1p9ITd-1}{\nwixu{NW192eu0-2EtURf-1}\nwixd{NW192eu0-1p9ITd-1}}}%
\nwixlogsorted{c}{{the last element of a name is a suffix}{NW192eu0-2t3lxE-1}{\nwixu{NW192eu0-4Zlwoj-1}\nwixd{NW192eu0-2t3lxE-1}}}%
\nwixlogsorted{c}{{then return the \code{}last-name\edoc{} of all but the last element of the name}{NW192eu0-3W6gHs-1}{\nwixu{NW192eu0-4Zlwoj-1}\nwixd{NW192eu0-3W6gHs-1}}}%
\nwixlogsorted{c}{{then return the first-name of the rest of the name}{NW192eu0-2nVNHx-1}{\nwixu{NW192eu0-1xnn0Z-1}\nwixd{NW192eu0-2nVNHx-1}}}%
\nwixlogsorted{c}{{titles}{NW192eu0-BpWdi-1}{\nwixd{NW192eu0-BpWdi-1}\nwixu{NW192eu0-2wUDG5-1}}}%
\nwixlogsorted{i}{{\nwixident{*ops*}}{*ops*}}%
\nwixlogsorted{i}{{\nwixident{*state*}}{*state*}}%
\nwixlogsorted{i}{{\nwixident{*suffixes*}}{*suffixes*}}%
\nwixlogsorted{i}{{\nwixident{*titles*}}{*titles*}}%
\nwixlogsorted{i}{{\nwixident{achieve}}{achieve}}%
\nwixlogsorted{i}{{\nwixident{apply-op}}{apply-op}}%
\nwixlogsorted{i}{{\nwixident{appropriate-p}}{appropriate-p}}%
\nwixlogsorted{i}{{\nwixident{assert-solved}}{assert-solved}}%
\nwixlogsorted{i}{{\nwixident{count-atoms}}{count-atoms}}%
\nwixlogsorted{i}{{\nwixident{find-all}}{find-all}}%
\nwixlogsorted{i}{{\nwixident{GPS}}{GPS}}%
\nwixlogsorted{i}{{\nwixident{last-name}}{last-name}}%
\nwixlogsorted{i}{{\nwixident{power}}{power}}%
\nwixlogsorted{i}{{\nwixident{square}}{square}}%
\nwbegindocs{83}\nwdocspar

\chapter{Chunks}
\nowebchunks

\chapter{Index}
\nowebindex

\bibliography{paip}
\bibliographystyle{plainnat}

\end{document}
\nwenddocs{}
